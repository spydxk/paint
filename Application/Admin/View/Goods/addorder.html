<!DOCTYPE HTML>

<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link href="{$Think.const.ADMIN_CSS_URL}/H-ui.min.css" rel="stylesheet" type="text/css" />
    <link href="{$Think.const.ADMIN_URL}/lib/font-awesome/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="{$Think.const.ADMIN_URL}/lib/Hui-iconfont/1.0.7/iconfont.css" />
    <link rel="stylesheet" type="text/css" href="{$Think.const.ADMIN_URL}/lib/icheck/icheck.css" />
    <link href="{$Think.const.ADMIN_URL}/lib/iconfont/iconfont.css" rel="stylesheet" type="text/css" />
    <link href="{$Think.const.ADMIN_CSS_URL}/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link href="{$Think.const.ADMIN_CSS_URL}/animate.min.css" rel="stylesheet">
    <link href="{$Think.const.ADMIN_CSS_URL}/style.min862f.css?v=4.1.0" rel="stylesheet">
    <title>列表</title>
    <style>
    #DataTables_Table_0_wrapper img {
        height: 100px;
    }

    td {
        text-align: center;
    }

    .inp {
        width: 100px;
    }
    </style>
</head>

<body>
    <div style="font-size: 13px;margin: 10px 5px">
        <form action="<?php echo U('Goods/addorderdata')?>" method="post" enctype="multipart/form-data" id='form-product'>
            <table border="1" width="100%" class="table table-border table-bordered radius  table-hover">
                <tr>
                    <th colspan="2" style="text-align: center;">为{$data['name']}添加交易记录</th>
                </tr>
                <tr>
                    <td>交易日期</td>
                    <td>
                        <!-- <literal> -->
                        <div class="col-sm-10">
                            <input class="form-control layer-date" placeholder="YYYY-MM-DD" onclick="laydate({ istime: true, format: 'YYYY-MM-DD' })" name="addtime">
                            <label class="laydate-icon"></label>
                        </div>
                        <!-- </literal> -->
                    </td>
                </tr>
                <tr>
                    <td>客户名称</td>
                    <td>
                        <input type="text" name='gressname' class="input-text" id="gressname" />
                    </td>
                </tr>
                <tr>
                    <td>联系电话</td>
                    <td>
                        <input type="text" name='order_iphone' class="input-text" id="order_iphone" />
                    </td>
                </tr>
                </tr>
                <tr>
                    <td>地址</td>
                    <td>
                        <input type="text" name='order_address' class="input-text" id="order_address" />
                    </td>
                </tr>
                <tr>
                    <td>开单人：</td>
                    <td>
                        <input type="text" name='order_user' class="input-text" id="order_user" />
                    </td>
                </tr>
                <tr>
                    <td>送货人：</td>
                    <td>
                        <input type="text" name='delivery_user' class="input-text" id='delivery_user' />
                    </td>
                </tr>
                <tr>
                    <td>收货人：</td>
                    <td>
                        <input type="text" name='consignee' class="input-text" id="consignee" />
                    </td>
                </tr>
            </table>
            <table border="1" width="100%" class="table table-border table-bordered radius table-hover goods">
                <tr>
                    <th colspan="2"><span style="display: inline-block;text-align: center;width: 100%;">货品列表</span>
                        <input type="button" class="btn btn-primary size-S radius" style="float: right;z-index: 100000;" value="添加货品记录" onclick="addgood()" />
                    </th>
                </tr>
                <tr class="good_list1">
                    <th colspan="2"><span style="display: inline-block;text-align: center;width: 100%;">第1批货品</span>
                        <input type="button" class="btn btn-primary size-S radius deletegoods" style="float: right;z-index: 100000;" value="删除货品" onclick="delgood(1)" />
                    </th>
                </tr>
                <tr class="good_list1">
                    <th>货品名称</th>
                    <td>
                        <input type="text" name='goods_name1' class="input-text" />
                    </td>
                </tr>
                <tr class="good_list1">
                    <th>规格型号</th>
                    <td>
                        <input type="text" name='goods_type1' class="input-text" />
                    </td>
                </tr>
                <tr class="good_list1">
                    <th>数量</th>
                    <td>
                        <input type="text" name='goods_num1' class="input-text checknum" />
                    </td>
                </tr>
                <tr class="good_list1">
                    <th>单位</th>
                    <td>
                        <input type="text" name='goods_unit1' class="input-text" />
                    </td>
                </tr>
                <tr class="good_list1">
                    <th>单价</th>
                    <td>
                        <input type="text" name='goods_price1' class="input-text checknum" />
                    </td>
                </tr>
                <tr class="good_list1">
                    <th>总金额</th>
                    <td>
                        <input type="text" name='goods_all1' class="input-text checknum" />
                    </td>
                </tr>
                <tr class="good_list1">
                    <th>备注</th>
                    <td>
                        <input type="text" name='notes1' class="input-text" />
                    </td>
                </tr>
            </table>
            <table border="1" width="100%" class="table table-border table-bordered radius table-hover">
                <tr>
                    <th>货单总额</th>
                    <td>
                        <input type="text" style="display: none;" name="user_id" value="{$data['id']|encoded}">
                        <input type="text" name='money_all' class="input-text" id="money_all" />
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align: center;">
                        <input type="button" value="提交" class="btn btn-primary size-S radius submit" />
                    </td>
                </tr>
            </table>
        </form>
    </div>
</body>
<!-- <script type="text/javascript" src="{$Think.const.ADMIN_URL}/lib/jquery/1.9.1/jquery.min.js"></script> -->
<!-- <script type="text/javascript" src="{$Think.const.ADMIN_URL}/lib/My97DatePicker/WdatePicker.js"></script> -->
<script src="{$Think.const.ADMIN_URL}/js/jquery.min.js?v=2.1.4"></script>
<script src="{$Think.const.ADMIN_URL}/js/bootstrap.min.js?v=3.3.6"></script>
<script src="{$Think.const.ADMIN_URL}/js/content.min.js?v=1.0.0"></script>
<script src="{$Think.const.ADMIN_URL}/js/plugins/layer/laydate/laydate.js"></script>
<script type="text/javascript">
window.i = 2;

function addgood() {
    var html = "<tr class='good_list" + window.i + "'><th colspan='2'><span style='display: inline-block;text-align: center;width: 100%;'>第" + window.i + "批货品</span><input type='button' class='btn btn-primary size-S radius deletegoods' style='float: right;' value='删除货品' onclick='delgood(" + window.i + ")' /></th></tr><tr class='good_list" + window.i + "'><th>货品名称</th><td><input type='text' name='goods_name" + window.i + "' class='input-text' /></td></tr><tr class='good_list" + window.i + "'><th>规格型号</th><td><input type='text' name='goods_type" + window.i + "' class='input-text' /></td></tr><tr class='good_list" + window.i + "'><th>数量</th><td><input type=text name='goods_num" + window.i + "' class='input-text' /></td></tr><tr class='good_list" + window.i + "'><th>单位</th><td><input type='text' name='goods_unit" + window.i + "' class='input-text' /></td></tr><tr class='good_list" + window.i + "'><th>单价</th><td><input type='text' name='goods_price'" + window.i + "' class='input-text' /></td></tr class='good_list" + window.i + "'><tr class='good_list" + window.i + "'><th>总金额</th><td><input type='text' name='goods_all" + window.i + "'class='input-text' /></td></tr><tr class='good_list" + window.i + "'><th>备注</th><td><input type=text name='notes" + window.i + "' class='input-text' /></td></tr>";
    $('.goods').append(html);
    window.i++;
}

function delgood(id) {
    $('.good_list' + id).remove();
}
$(function() {
    $(".submit").click(function() {
        var date = $('#datemin').val();
        if (date == '') {
            alert('请选择交易日期');
            return;
        }
        var gressname = $('#gressname').val();
        if (gressname == '') {
            alert('请填写客户名称');
            return;
        }
        var order_iphone = $('#order_iphone').val();
        if (order_iphone == '') {
            alert('请填写联系电话');
            return;
        }
        var order_address = $('#order_address').val();
        if (order_address == '') {
            alert('请填写地址');
            return;
        }
        var order_user = $('#order_user');
        if (order_user == '') {
            alert('请填写开单人');
            return;
        }
        var delivery_user = $('#delivery_user');
        if (delivery_user == '') {
            alert('请填写送货人');
            return;
        }
        var consignee = $('#consignee');
        if (consignee == '') {
            alert('请填写收货人');
            return;
        }
        $(".checknum").each(function() {
            if (!(checkNumber($(this).val()))){
                alert('货品的数量、单价、总金额必须为数字');
                exit();
            }
        });
        var money_all = $('#money_all').val();
        if (money_all == '') {
            alert('请填写货单总额');
            return;
        }
        if (!(checkNumber(money_all))) {
            alert('货单总额必须为数字');
            return;
        };
        $('#form-product').submit();
    })
});

function checkNumber(theObj) {
    var reg = /^[0-9]+.?[0-9]*$/;
    if (reg.test(theObj)) {
        return true;
    }
    return false;
}
</script>

</html>